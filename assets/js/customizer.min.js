function RepeaterRow(e,t){this.rowIndex=e,this.rowNumber=e+1,this.$el=t,this.$dragger=this.$el.find(".repeater-row-move"),this.$minimizer=this.$el.find(".repeater-row-minimize"),this.$remover=this.$el.find(".repeater-row-remove"),this.$number=this.$el.find(".repeater-row-number"),this.$fields=this.$el.find("input,select,textarea");var i=this;this.$minimizer.on("click",function(){i.toggleMinimize()}),this.$remover.on("click",function(){i.remove()}),this.$dragger.on("mousedown",function(){i.$el.trigger("row:start-dragging")}),this.$el.on("keyup change","input, select, textarea",function(e){i.$el.trigger("row:update",[i.getRowIndex(),jQuery(e.target).data("field"),e.target])}),this.renderNumber()}function kirkiArrayToObject(e){var t={};if(null!==e)for(var i=0;i<e.length;++i)void 0!==e[i]&&(t[i]=e[i]);return t}wp.customize.controlConstructor["kirki-checkbox"]=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=jQuery(this).is(":checked")?!0:!1,e.setting.set(t)})}}),wp.customize.controlConstructor.code=wp.customize.Control.extend({ready:function(){var e=this,t=e.container.find("#kirki-codemirror-editor-"+e.id),i=CodeMirror.fromTextArea(t[0]);if("html"==e.params.choices.language)var n={name:"htmlmixed"};else n=e.params.choices.language;i.setOption("value",e.setting._value),i.setOption("mode",n),i.setOption("lineNumbers",!0),i.setOption("theme",e.params.choices.theme),i.setOption("height",e.params.choices.height+"px"),i.on("change",function(){e.setting.set(i.getValue())}),t.parents(".accordion-section").on("click",function(){i.refresh()})}}),wp.customize.controlConstructor["color-alpha"]=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find(".kirki-color-control"),i=t.val();t.wpColorPicker({change:function(i,n){setTimeout(function(){e.setting.set(t.val())},100)}})}}),wp.customize.controlConstructor.dimension=wp.customize.Control.extend({ready:function(){var e=this,t=e.container.find("input[type=number]").val(),i=e.container.find("select").val();jQuery(".customize-control-dimension select").selectize(),this.container.on("change","input",function(){t=jQuery(this).val(),e.setting.set(t+i)}),this.container.on("change","select",function(){i=jQuery(this).val(),e.setting.set(t+i)})}}),function($){wp.customizerCtrlEditor={init:function(){$(window).load(function(){$("textarea.wp-editor-area").each(function(){var e=$(this),t=e.attr("id"),i=tinyMCE.get(t),n,o;i&&i.onChange.add(function(t,r){t.save(),o=i.getContent(),clearTimeout(n),n=setTimeout(function(){e.val(o).trigger("change")},500)}),e.css({visibility:"visible"}).on("keyup",function(){o=e.val(),clearTimeout(n),n=setTimeout(function(){o.trigger("change")},500)})})})}},wp.customizerCtrlEditor.init()}(jQuery),wp.customize.controlConstructor.multicheck=wp.customize.Control.extend({ready:function(){var e=this;e.container.on("change","input",function(){var t=[],i=0;jQuery.each(e.params.choices,function(e,n){jQuery('input[value="'+e+'"').is(":checked")&&(t[i]=e,i++)}),e.setting.set(t),wp.customize.previewer.refresh()})}}),wp.customize.controlConstructor.number=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("input");if(jQuery(t).spinner(),e.params.choices.min&&jQuery(t).spinner("option","min",e.params.choices.min),e.params.choices.min&&jQuery(t).spinner("option","max",e.params.choices.max),e.params.choices.min){var i="any"==e.params.choises.step?"0.001":e.params.choices.step;jQuery(t).spinner("option","step",i)}this.container.on("change","input",function(){e.setting.set(jQuery(this).val())}),this.container.on("click","input",function(){e.setting.set(jQuery(this).val())}),this.container.on("keyup","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.palette=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.preset=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("select");jQuery(t).selectize(),this.container.on("change","select",function(){var t=jQuery(this).val();e.setting.set(t),jQuery.each(e.params.choices,function(e,i){t==e&&jQuery.each(i.settings,function(e,t){var i=wp.customize.settings.controls[e];if(void 0===typeof i)return!0;var n=i.type;if("checkbox"==n||"switch"==n||"toggle"==n||"kirki-checkbox"==n){var o=wp.customize.control(e).container.find("input");1==t?(jQuery(o).prop("checked",!0),wp.customize.instance(e).set(!0)):(jQuery(o).prop("checked",!1),wp.customize.instance(e).set(!1))}else if("select"==n||"select2"==n||"select2-multiple"==n||"kirki-select"==n){var o=wp.customize.control(e).container.find("select"),r=jQuery(o).selectize(),s=r[0].selectize;s.setValue(t,!0),wp.customize.instance(e).set(t)}else if("slider"==n){var o=wp.customize.control(e).container.find("input");jQuery(o).prop("value",t);var a=wp.customize.control(e).container.find(".kirki_range_value .value");jQuery(a).html(t),wp.customize.instance(e).set(t)}else if("textarea"==n||"kirki-textarea"==n){var o=wp.customize.control(e).container.find("textarea");jQuery(o).prop("value",t),wp.customize(e).set(t)}else if("color"==n||"kirki-color"==n)wp.customize.instance(e).set(t),wp.customize.control(e).container.find(".color-picker-hex").attr("data-default-color",t).data("default-color",t).wpColorPicker("color",t);else if("color-alpha"==n){var c=wp.customize.control(e).container.find(".kirki-color-control");c.attr("data-default-color",t).data("default-color",t).wpColorPicker("color",t),wp.customize.instance(e).set(t)}else if("dimension"==n){wp.customize.instance(e).set(t);var o=wp.customize.control(e).container.find("input[type=number]"),u=parseFloat(t);jQuery(o).prop("value",u);var l=wp.customize.control(e).container.find("select"),h=t.replace(parseFloat(t),"");jQuery(l).prop("value",h)}else if("multicheck"==n)for(wp.customize.instance(e).set(t),wp.customize.control(e).container.find("input").each(function(){jQuery(this).prop("checked",!1)}),index=0;index<t.length;index++){var o=wp.customize.control(e).container.find('input[value="'+t[index]+'"]');jQuery(o).prop("checked",!0)}else if("radio-buttonset"==n||"radio-image"==n||"radio"==n||"kirki-radio"==n){var o=wp.customize.control(e).container.find('input[value="'+t+'"]');jQuery(o).prop("checked",!0),wp.customize.instance(e).set(t)}else{var o=wp.customize.control(e).container.find("input");jQuery(o).prop("value",t),wp.customize.instance(e).set(t)}})}),wp.customize.previewer.refresh()})}}),wp.customize.controlConstructor["radio-buttonset"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["radio-image"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["kirki-radio"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change","input",function(){e.setting.set(jQuery(this).val())})}}),RepeaterRow.prototype.getRowIndex=function(){return this.rowIndex},RepeaterRow.prototype.getRowNumber=function(){return this.rowNumber},RepeaterRow.prototype.setRowNumber=function(e){this.rowNumber=e,this.renderNumber()},RepeaterRow.prototype.getElement=function(){return this.$el},RepeaterRow.prototype.setRowIndex=function(e){this.rowIndex=e,this.$el.attr("data-row",e),this.$el.data("row",e)},RepeaterRow.prototype.toggleMinimize=function(){this.$el.toggleClass("minimized"),this.$minimizer.find(".repeater-minimize").toggleClass("dashicons-arrow-up"),this.$minimizer.find(".repeater-minimize").toggleClass("dashicons-arrow-down")},RepeaterRow.prototype.minimize=function(){this.$el.addClass("minimized"),this.$minimizer.find(".repeater-minimize").removeClass("dashicons-arrow-up"),this.$minimizer.find(".repeater-minimize").addClass("dashicons-arrow-down")},RepeaterRow.prototype.remove=function(){confirm("Are you sure?")&&(this.$el.slideUp(300,function(){jQuery(this).detach()}),this.$el.trigger("row:remove",[this.getRowIndex()]))},RepeaterRow.prototype.renderNumber=function(){this.$number.text(this.getRowNumber())},wp.customize.controlConstructor.repeater=wp.customize.Control.extend({ready:function(){var e=this,t=this.params.value;if(this.settingField=this.container.find("[data-customize-setting-link]").first(),this.setValue([],!1),this.repeaterFieldsContainer=e.container.find(".repeater-fields").first(),this.currentIndex=0,this.rows=[],e.container.on("click","button.repeater-add",function(t){t.preventDefault(),e.addRow()}),this.repeaterTemplate=_.memoize(function(){var t,i={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(n){return(t=_.template(e.container.find(".customize-control-repeater-content").first().html(),null,i))(n)}}),t.length)for(var i=0;i<t.length;i++)e.addRow(t[i]);this.repeaterFieldsContainer.sortable({handle:".repeater-row-move",update:function(t,i){e.sort()}})},getValue:function(){return JSON.parse(decodeURI(this.setting.get()))},setValue:function(e,t){this.setting.set(encodeURI(JSON.stringify(e))),t&&this.settingField.trigger("change")},addRow:function(e){var t=this,i,n,o=t.repeaterTemplate(),r=this.getValue(),s={},a;if(o){if(a=jQuery.extend(!0,{},t.params.fields),e)for(i in e)e.hasOwnProperty(i)&&a.hasOwnProperty(i)&&(a[i]["default"]=e[i]);a.index=this.currentIndex,a.ControlId=this.id,o=o(a);var c=new RepeaterRow(t.currentIndex,jQuery(o).appendTo(t.repeaterFieldsContainer));c.getElement().one("row:remove",function(e,i){t.deleteRow(i)}),c.getElement().on("row:update",function(e,i,n,o){t.updateField.call(t,e,i,n,o)}),c.getElement().on("row:start-dragging",function(){for(i in t.rows)t.rows.hasOwnProperty(i)&&t.rows[i]&&t.rows[i].minimize()}),this.rows[this.currentIndex]=c;for(i in a)a.hasOwnProperty(i)&&(s[i]=a[i]["default"]);r[this.currentIndex]=s,this.setValue(r,!0),this.currentIndex++}},sort:function(){var e=this,t=this.repeaterFieldsContainer.find(".repeater-row"),i=[];t.each(function(e,t){i.push(jQuery(t).data("row"))});var n=e.getValue(),o=[],r=[];jQuery.each(i,function(t,i){o[t]=e.rows[i],o[t].setRowIndex(t),o[t].setRowNumber(t+1),r[t]=n[i]}),e.rows=o,e.setValue(r)},deleteRow:function(e){var t=this.getValue();if(t[e]){var i=this.rows[e];i&&(delete t[e],delete this.rows[e],this.setValue(t,!0))}var n=1;for(prop in this.rows)this.rows.hasOwnProperty(prop)&&this.rows[prop]&&(this.rows[prop].setRowNumber(n),n++)},updateField:function(e,t,i,n){if(this.rows[t]&&this.params.fields[i]){var o=this.params.fields[i].type,r=this.rows[t],s=this.getValue();n=jQuery(n),void 0!=typeof s[r.getRowIndex()][i]&&("checkbox"==o?s[r.getRowIndex()][i]=n.is(":checked"):s[r.getRowIndex()][i]=n.val(),this.setValue(s,!0))}}}),wp.customize.controlConstructor["kirki-select"]=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("select"),i=parseInt(t.data("multiple"));i>1?jQuery(t).selectize({maxItems:i,plugins:["remove_button","drag_drop"]}):jQuery(t).selectize(),this.container.on("change","select",function(){if(i>1)var t=kirkiArrayToObject(jQuery(this).val());else var t=jQuery(this).val();e.setting.set(t)})}}),jQuery(document).ready(function($){$("input[type=range]").on("mousedown",function(){value=$(this).attr("value"),$(this).mousemove(function(){value=$(this).attr("value"),$(this).closest("label").find(".kirki_range_value .value").text(value)})}),$(".kirki-slider-reset").click(function(){var e=$(this).closest("label").find("input"),t=e.data("customize-setting-link"),i=e.data("reset_value");e.val(i),e.change()})}),wp.customize.controlConstructor.slider=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.sortable=wp.customize.Control.extend({ready:function(){var e=this;this.settingField=this.container.find("[data-customize-setting-link]").first(),this.sortableContainer=this.container.find("ul.sortable").first(),this.setValue(this.setting.get(),!1),this.sortableContainer.sortable().disableSelection().on("sortstop",function(t,i){e.sort()}).find("li").each(function(){jQuery(this).find("i.visibility").click(function(){jQuery(this).toggleClass("dashicons-visibility-faint").parents("li:eq(0)").toggleClass("invisible")})}).click(function(){e.sort()})},sort:function(){var e=[];this.sortableContainer.find("li").each(function(){var t=jQuery(this);t.is(".invisible")||e.push(t.data("value"))}),this.setValue(e,!0)},getValue:function(){return unserialize(this.setting.get())},setValue:function(e,t){e=serialize(e),this.setting.set(e),this.settingField.val(e),t&&this.settingField.trigger("change")}}),wp.customize.controlConstructor.spacing=wp.customize.Control.extend({ready:function(){var e=this,t={};if(e.container.has(".top").size()&&(t.top=e.setting._value.top),e.container.has(".bottom").size()&&(t.bottom=e.setting._value.bottom),e.container.has(".left").size()&&(t.left=e.setting._value.left),e.container.has(".right").size()&&(t.right=e.setting._value.right),jQuery(".customize-control-spacing select").selectize(),e.container.has(".top").size()){var i=e.container.find(".top input[type=number]").val(),n=e.container.find(".top select").val();this.container.on("change",".top input",function(){i=jQuery(this).val(),t.top=i+n,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".top select",function(){n=jQuery(this).val(),t.top=i+n,e.setting.set(t),wp.customize.previewer.refresh()})}if(e.container.has(".bottom").size()){var o=e.container.find(".bottom input[type=number]").val(),r=e.container.find(".bottom select").val();this.container.on("change",".bottom input",function(){o=jQuery(this).val(),t.bottom=o+r,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".bottom select",function(){r=jQuery(this).val(),t.bottom=o+r,e.setting.set(t),wp.customize.previewer.refresh()})}if(e.container.has(".left").size()){var s=e.container.find(".left input[type=number]").val(),a=e.container.find(".left select").val();this.container.on("change",".left input",function(){s=jQuery(this).val(),t.left=s+a,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".left select",function(){a=jQuery(this).val(),t.left=s+a,e.setting.set(t),wp.customize.previewer.refresh()})}if(e.container.has(".right").size()){var c=e.container.find(".right input[type=number]").val(),u=e.container.find(".right select").val();this.container.on("change",".right input",function(){c=jQuery(this).val(),t.right=c+u,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".right select",function(){u=jQuery(this).val(),t.right=c+u,e.setting.set(t),wp.customize.previewer.refresh()})}}}),wp.customize.controlConstructor["switch"]=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=jQuery(this).is(":checked")?!0:!1,e.setting.set(t)})}}),wp.customize.controlConstructor["kirki-text"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change keyup paste","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["kirki-textarea"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change keyup paste",".textarea",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.toggle=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=jQuery(this).is(":checked")?!0:!1,e.setting.set(t)})}}),wp.customize.controlConstructor.typography=wp.customize.Control.extend({ready:function(){var e=this,t={};if(e.container.has(".bold").size()&&(t.bold=e.setting._value.bold),e.container.has(".italic").size()&&(t.italic=e.setting._value.italic),e.container.has(".underline").size()&&(t.underline=e.setting._value.underline),e.container.has(".strikethrough").size()&&(t.strikethrough=e.setting._value.strikethrough),e.container.has(".font-family").size()&&(t["font-family"]=e.setting._value["font-family"]),e.container.has(".font-size").size()&&(t["font-size"]=e.setting._value["font-size"]),e.container.has(".font-weight").size()&&(t["font-weight"]=e.setting._value["font-weight"]),e.container.has(".line-height").size()&&(t["line-height"]=e.setting._value["line-height"]),e.container.has(".letter-spacing").size()&&(t["letter-spacing"]=e.setting._value["letter-spacing"]),e.container.has(".color").size()&&(t.color=e.setting._value.color),jQuery(".customize-control-typography select").selectize(),e.container.has(".bold").size()&&this.container.on("change",".bold input",function(){jQuery(this).is(":checked")?t.bold=!0:t.bold=!1,e.setting.set(t),wp.customize.previewer.refresh()}),e.container.has(".italic").size()&&this.container.on("change",".italic input",function(){jQuery(this).is(":checked")?t.italic=!0:t.italic=!1,e.setting.set(t),wp.customize.previewer.refresh()}),e.container.has(".underline").size()&&this.container.on("change",".underline input",function(){jQuery(this).is(":checked")?t.underline=!0:t.underline=!1,e.setting.set(t),wp.customize.previewer.refresh()}),e.container.has(".strikethrough").size()&&this.container.on("change",".strikethrough input",function(){jQuery(this).is(":checked")?t.strikethrough=!0:t.strikethrough=!1,e.setting.set(t),wp.customize.previewer.refresh()}),e.container.has(".font-family").size()&&this.container.on("change",".font-family select",function(){t["font-family"]=jQuery(this).val(),e.setting.set(t),wp.customize.previewer.refresh()}),e.container.has(".font-size").size()){var i=e.container.find(".font-size input[type=number]").val(),n=e.container.find(".font-size select").val();this.container.on("change",".font-size input",function(){i=jQuery(this).val(),t["font-size"]=i+n,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".font-size select",function(){n=jQuery(this).val(),t["font-size"]=i+n,e.setting.set(t),wp.customize.previewer.refresh()})}if(e.container.has(".font-weight").size()&&this.container.on("change",".font-weight select",function(){t["font-weight"]=jQuery(this).val(),e.setting.set(t),wp.customize.previewer.refresh()}),e.container.has(".line-height").size()&&this.container.on("change",".line-height input",function(){t["line-height"]=jQuery(this).val(),e.setting.set(t),wp.customize.previewer.refresh()}),e.container.has(".letter-spacing").size()){var o=e.container.find(".letter-spacing input[type=number]").val(),r=e.container.find(".letter-spacing select").val();this.container.on("change",".letter-spacing input",function(){o=jQuery(this).val(),t["letter-spacing"]=o+r,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".letter-spacing select",function(){r=jQuery(this).val(),t["letter-spacing"]=o+r,e.setting.set(t),wp.customize.previewer.refresh()})}if(e.container.has(".color").size()){var s=this.container.find(".kirki-color-control");s.wpColorPicker({change:function(){setTimeout(function(){t.color=s.val(),e.setting.set(t),wp.customize.previewer.refresh()},100)}})}}});
//# sourceMappingURL=./customizer.min.js.map